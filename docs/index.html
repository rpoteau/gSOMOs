

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SOMOs documentation &mdash; SOMOs 0.2.5 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
    <link rel="canonical" href="https://tonuser.github.io/gSOMOs/index.html" />
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=cb850272"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="#" class="icon icon-home">
            SOMOs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">SOMOs documentation</a><ul>
<li><a class="reference internal" href="#somos.io.extract_gaussian_info"><code class="docutils literal notranslate"><span class="pre">extract_gaussian_info()</span></code></a></li>
<li><a class="reference internal" href="#somos.io.load_mos_from_cclib"><code class="docutils literal notranslate"><span class="pre">load_mos_from_cclib()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.analyzeSimilarity"><code class="docutils literal notranslate"><span class="pre">analyzeSimilarity()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.build_full_similarity_table"><code class="docutils literal notranslate"><span class="pre">build_full_similarity_table()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.cluster_orbitals"><code class="docutils literal notranslate"><span class="pre">cluster_orbitals()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.cosine_similarity_with_overlap"><code class="docutils literal notranslate"><span class="pre">cosine_similarity_with_overlap()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.cross_match_all"><code class="docutils literal notranslate"><span class="pre">cross_match_all()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.find_somo_candidates"><code class="docutils literal notranslate"><span class="pre">find_somo_candidates()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.heatmap_MOs"><code class="docutils literal notranslate"><span class="pre">heatmap_MOs()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.interactive_similarity"><code class="docutils literal notranslate"><span class="pre">interactive_similarity()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.save_similarity_per_somo_from_df"><code class="docutils literal notranslate"><span class="pre">save_similarity_per_somo_from_df()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.scalar_product_with_overlap"><code class="docutils literal notranslate"><span class="pre">scalar_product_with_overlap()</span></code></a></li>
<li><a class="reference internal" href="#somos.cosim.tsne"><code class="docutils literal notranslate"><span class="pre">tsne()</span></code></a></li>
<li><a class="reference internal" href="#somos.proj.compute_orbital_projections"><code class="docutils literal notranslate"><span class="pre">compute_orbital_projections()</span></code></a></li>
<li><a class="reference internal" href="#somos.proj.compute_projection_matrix_and_eigenvalues"><code class="docutils literal notranslate"><span class="pre">compute_projection_matrix_and_eigenvalues()</span></code></a></li>
<li><a class="reference internal" href="#somos.proj.identify_somos_from_projection"><code class="docutils literal notranslate"><span class="pre">identify_somos_from_projection()</span></code></a></li>
<li><a class="reference internal" href="#somos.proj.parse_beta_contrib_string"><code class="docutils literal notranslate"><span class="pre">parse_beta_contrib_string()</span></code></a></li>
<li><a class="reference internal" href="#somos.proj.print_eigen_analysis"><code class="docutils literal notranslate"><span class="pre">print_eigen_analysis()</span></code></a></li>
<li><a class="reference internal" href="#somos.proj.project_occupied_alpha_onto_beta"><code class="docutils literal notranslate"><span class="pre">project_occupied_alpha_onto_beta()</span></code></a></li>
<li><a class="reference internal" href="#somos.proj.projection_heatmap_from_df"><code class="docutils literal notranslate"><span class="pre">projection_heatmap_from_df()</span></code></a></li>
<li><a class="reference internal" href="#somos.proj.show_alpha_to_homo"><code class="docutils literal notranslate"><span class="pre">show_alpha_to_homo()</span></code></a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">SOMOs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="#" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">SOMOs documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="somos-documentation">
<h1>SOMOs documentation<a class="headerlink" href="#somos-documentation" title="Link to this heading"></a></h1>
<a class="reference internal image-reference" href="_static/pyPCBanner.svg"><img alt="SOMOs banner" class="align-center" src="_static/pyPCBanner.svg" style="width: 1000px;" />
</a>
<p>Download the scientific documentation here:
<a class="reference download internal" download="" href="_downloads/f4fe0647be26c71637420b08a160fa20/projection-v2.pdf"><code class="xref download docutils literal notranslate"><span class="pre">projection-v2.pdf</span></code></a></p>
<dl class="py function" id="module-somos.io">
<dt class="sig sig-object py" id="somos.io.extract_gaussian_info">
<span class="sig-prename descclassname"><span class="pre">somos.io.</span></span><span class="sig-name descname"><span class="pre">extract_gaussian_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfile_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.io.extract_gaussian_info" title="Link to this definition"></a></dt>
<dd><p>Extracts molecular orbital and structural information from a Gaussian log file using cclib.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>logfile_path</strong> (<em>str</em>) – Path to the Gaussian .log file.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A dictionary containing UDFT/DFT type, basis size, molecular orbitals, geometry,
occupation, HOMO index, spin values, and the AO overlap matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.io.load_mos_from_cclib">
<span class="sig-prename descclassname"><span class="pre">somos.io.</span></span><span class="sig-name descname"><span class="pre">load_mos_from_cclib</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfolder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.io.load_mos_from_cclib" title="Link to this definition"></a></dt>
<dd><p>Loads molecular orbital data from Gaussian output using cclib and organizes them into DataFrames.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfolder</strong> (<em>str</em><em> or </em><em>Path</em>) – Directory containing the log file.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – Name of the Gaussian .log file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Alpha and beta DataFrames, coefficient matrices, basis count, overlap matrix, and full info dictionary.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-somos.cosim">
<dt class="sig sig-object py" id="somos.cosim.analyzeSimilarity">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">analyzeSimilarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfolder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.analyzeSimilarity" title="Link to this definition"></a></dt>
<dd><p>Full analysis pipeline to extract, match, and compare alpha and beta molecular orbitals.
Displays interactive similarity widgets and saves annotated similarity results to Excel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfolder</strong> (<em>str</em><em> or </em><em>Path</em>) – Path to the folder containing the Gaussian log file.</p></li>
<li><p><strong>logfile</strong> (<em>str</em>) – Filename of the Gaussian log file.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Alpha/beta DataFrames, coefficient matrices, nbasis, SOMO DataFrame, and overlap matrix.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.build_full_similarity_table">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">build_full_similarity_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbasis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lumo_plusAlpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lumo_plusBeta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.build_full_similarity_table" title="Link to this definition"></a></dt>
<dd><p>Builds a similarity matrix between selected alpha and beta MOs and returns optimal matches.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lMOs</strong> (<em>tuple</em><em> of </em><em>pd.DataFrame</em>) – Alpha and beta orbital DataFrames.</p></li>
<li><p><strong>cMOs</strong> (<em>tuple</em><em> of </em><em>np.ndarray</em>) – Coefficient matrices for alpha and beta MOs.</p></li>
<li><p><strong>nbasis</strong> (<em>int</em>) – Number of basis functions.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – Overlap matrix.</p></li>
<li><p><strong>lumo_plusAlpha</strong> (<em>int</em>) – Number of virtual alpha orbitals to include beyond LUMO.</p></li>
<li><p><strong>lumo_plusBeta</strong> (<em>int</em>) – Number of virtual beta orbitals to include beyond LUMO.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with matches, similarity matrix, and selected alpha indices.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.cluster_orbitals">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">cluster_orbitals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">MOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'alpha'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.cluster_orbitals" title="Link to this definition"></a></dt>
<dd><p>Performs hierarchical clustering of molecular orbitals based on cosine similarity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>MOs</strong> (<em>tuple</em><em> of </em><em>np.ndarray</em>) – Tuple containing coefficient matrices for alpha and beta orbitals.</p></li>
<li><p><strong>spin</strong> (<em>str</em>) – Spin type to cluster (‘alpha’ or ‘beta’).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.cosine_similarity_with_overlap">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">cosine_similarity_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.cosine_similarity_with_overlap" title="Link to this definition"></a></dt>
<dd><p>Computes the cosine similarity between two coefficient vectors using an overlap matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ci</strong> (<em>np.ndarray</em>) – Coefficient vector i.</p></li>
<li><p><strong>cj</strong> (<em>np.ndarray</em>) – Coefficient vector j.</p></li>
<li><p><strong>S</strong> (<em>np.ndarray</em>) – Overlap matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Cosine similarity between ci and cj.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.cross_match_all">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">cross_match_all</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbasis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_virtual_alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.cross_match_all" title="Link to this definition"></a></dt>
<dd><p>Matches alpha and beta MOs by maximizing similarity and computes their pairwise similarity and energy difference.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_df</strong> (<em>pd.DataFrame</em>) – DataFrame for alpha orbitals.</p></li>
<li><p><strong>beta_df</strong> (<em>pd.DataFrame</em>) – DataFrame for beta orbitals.</p></li>
<li><p><strong>alpha_mat</strong> (<em>np.ndarray</em>) – Alpha orbital coefficients.</p></li>
<li><p><strong>beta_mat</strong> (<em>np.ndarray</em>) – Beta orbital coefficients.</p></li>
<li><p><strong>nbasis</strong> (<em>int</em>) – Number of basis functions.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – Overlap matrix.</p></li>
<li><p><strong>n_virtual_alpha</strong> (<em>int</em>) – Number of virtual alpha orbitals to include.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Table with matching alpha-beta pairs, similarity scores, and energy differences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.find_somo_candidates">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">find_somo_candidates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbasis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spin</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.find_somo_candidates" title="Link to this definition"></a></dt>
<dd><p>Identifies singly occupied molecular orbital (SOMO) candidates by comparing
similarities between occupied alpha and all beta orbitals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_df</strong> (<em>pd.DataFrame</em>) – DataFrame for alpha orbitals.</p></li>
<li><p><strong>beta_df</strong> (<em>pd.DataFrame</em>) – DataFrame for beta orbitals.</p></li>
<li><p><strong>alpha_mat</strong> (<em>np.ndarray</em>) – Alpha orbital coefficients.</p></li>
<li><p><strong>beta_mat</strong> (<em>np.ndarray</em>) – Beta orbital coefficients.</p></li>
<li><p><strong>nbasis</strong> (<em>int</em>) – Number of basis functions.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – Overlap matrix.</p></li>
<li><p><strong>spin</strong> (<em>dict</em>) – spin[“S2”]: eigenvalue of the S2 operator (float)
spin[“S”]: S-value (float)
spin[“multiplicity”] (float, calculated after 2S+1)</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Maximum allowed similarity for SOMO detection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Table listing SOMO-like orbital pairs and their properties.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.heatmap_MOs">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">heatmap_MOs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbasis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logfile.log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.heatmap_MOs" title="Link to this definition"></a></dt>
<dd><p>Interactive cosine similarity heatmap between alpha and beta MOs around the HOMO-LUMO frontier.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lMOs</strong> (<em>tuple</em><em> of </em><em>pd.DataFrame</em>) – Alpha and beta orbital DataFrames.</p></li>
<li><p><strong>cMOs</strong> (<em>tuple</em><em> of </em><em>np.ndarray</em>) – Coefficient matrices for alpha and beta orbitals.</p></li>
<li><p><strong>nbasis</strong> (<em>int</em>) – Number of basis functions.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – Overlap matrix.</p></li>
<li><p><strong>logfolder</strong> (<em>str</em>) – Directory to save the heatmap PNG.</p></li>
<li><p><strong>logfilename</strong> (<em>str</em>) – Filename used as prefix for saving.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.interactive_similarity">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">interactive_similarity</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta_mat</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.interactive_similarity" title="Link to this definition"></a></dt>
<dd><p>Interactive widget to compute and display scalar product and cosine similarity between
selected alpha and beta MOs using the overlap matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha_df</strong> (<em>pd.DataFrame</em>) – DataFrame for alpha orbitals.</p></li>
<li><p><strong>beta_df</strong> (<em>pd.DataFrame</em>) – DataFrame for beta orbitals.</p></li>
<li><p><strong>alpha_mat</strong> (<em>np.ndarray</em>) – Coefficient matrix for alpha orbitals.</p></li>
<li><p><strong>beta_mat</strong> (<em>np.ndarray</em>) – Coefficient matrix for beta orbitals.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – Overlap matrix.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.save_similarity_per_somo_from_df">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">save_similarity_per_somo_from_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_SOMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbasis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfolder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.save_similarity_per_somo_from_df" title="Link to this definition"></a></dt>
<dd><p>Saves one Excel sheet per SOMO candidate listing similarities with all beta MOs,
sorted by decreasing similarity. Best match is highlighted in yellow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_SOMOs</strong> (<em>pd.DataFrame</em>) – DataFrame with identified SOMO candidates.</p></li>
<li><p><strong>lMOs</strong> (<em>tuple</em><em> of </em><em>pd.DataFrame</em>) – Alpha and beta orbital DataFrames.</p></li>
<li><p><strong>cMOs</strong> (<em>tuple</em><em> of </em><em>np.ndarray</em>) – Alpha and beta coefficient matrices.</p></li>
<li><p><strong>nbasis</strong> (<em>int</em>) – Number of basis functions.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – Overlap matrix.</p></li>
<li><p><strong>logfolder</strong> (<em>str</em><em> or </em><em>Path</em>) – Folder containing the log file.</p></li>
<li><p><strong>logfile</strong> (<em>str</em>) – Name of the log file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.scalar_product_with_overlap">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">scalar_product_with_overlap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">S</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.scalar_product_with_overlap" title="Link to this definition"></a></dt>
<dd><p>Computes the scalar product between two coefficient vectors using an overlap matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ci</strong> (<em>np.ndarray</em>) – Coefficient vector i.</p></li>
<li><p><strong>cj</strong> (<em>np.ndarray</em>) – Coefficient vector j.</p></li>
<li><p><strong>S</strong> (<em>np.ndarray</em>) – Overlap matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Scalar product ci^T S cj.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.cosim.tsne">
<span class="sig-prename descclassname"><span class="pre">somos.cosim.</span></span><span class="sig-name descname"><span class="pre">tsne</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfilename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logfile.log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.cosim.tsne" title="Link to this definition"></a></dt>
<dd><p>Performs a t-SNE projection of molecular orbitals (alpha and beta) using a cosine similarity
metric invariant to phase, and displays an interactive Plotly visualization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lMOs</strong> (<em>tuple</em><em> of </em><em>pd.DataFrame</em>) – DataFrames for alpha and beta molecular orbitals.</p></li>
<li><p><strong>cMOs</strong> (<em>tuple</em><em> of </em><em>np.ndarray</em>) – Coefficient matrices for alpha and beta orbitals.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – Overlap matrix used for computing cosine similarity.</p></li>
<li><p><strong>logfolder</strong> (<em>str</em>) – Path to the folder where the plot image will be saved.</p></li>
<li><p><strong>logfilename</strong> (<em>str</em>) – Name of the Gaussian log file used to prefix saved plots.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function" id="module-somos.proj">
<dt class="sig sig-object py" id="somos.proj.compute_orbital_projections">
<span class="sig-prename descclassname"><span class="pre">somos.proj.</span></span><span class="sig-name descname"><span class="pre">compute_orbital_projections</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.proj.compute_orbital_projections" title="Link to this definition"></a></dt>
<dd><p>Computes how much each alpha orbital is represented in the beta orbital space
using the AO overlap matrix S.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lMOs</strong> (<em>tuple</em><em> of </em><em>DataFrames</em>) – Tuple (alpha_df, beta_df), each containing orbital metadata.</p></li>
<li><p><strong>cMOs</strong> (<em>tuple</em><em> of </em><em>np.ndarray</em>) – Tuple (alpha_mat, beta_mat), each of shape (n_orbs, n_basis), with rows as orbitals.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – AO overlap matrix, shape (n_basis, n_basis).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with alpha orbital number, energy, occupation, and squared projection norm.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.proj.compute_projection_matrix_and_eigenvalues">
<span class="sig-prename descclassname"><span class="pre">somos.proj.</span></span><span class="sig-name descname"><span class="pre">compute_projection_matrix_and_eigenvalues</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cMOs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbasis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlap_matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.proj.compute_projection_matrix_and_eigenvalues" title="Link to this definition"></a></dt>
<dd><p>Computes the projection matrix P = A Aᵀ where A = alpha_occ · S · beta.T,
and returns its eigenvalues and eigenvectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lMOs</strong> (<em>tuple</em>) – Tuple containing two DataFrames: (alpha_df, beta_df), each with MO occupations and energies.</p></li>
<li><p><strong>cMOs</strong> (<em>tuple</em>) – Tuple of two np.ndarrays: (alpha_mat, beta_mat), each of shape (n_OMs, n_basis).
MOs are stored in rows (i.e., row i = MO_i).</p></li>
<li><p><strong>nbasis</strong> (<em>int</em>) – Number of basis functions.</p></li>
<li><p><strong>overlap_matrix</strong> (<em>np.ndarray</em>) – AO overlap matrix (shape: n_basis, n_basis).</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>eigenvalues</strong> (<em>np.ndarray</em>) – Eigenvalues of the projection matrix P.</p></li>
<li><p><strong>eigenvectors</strong> (<em>np.ndarray</em>) – Eigenvectors of the projection matrix P.</p></li>
<li><p><strong>P</strong> (<em>np.ndarray</em>) – The projection matrix P = A Aᵀ.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.proj.identify_somos_from_projection">
<span class="sig-prename descclassname"><span class="pre">somos.proj.</span></span><span class="sig-name descname"><span class="pre">identify_somos_from_projection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfolder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.proj.identify_somos_from_projection" title="Link to this definition"></a></dt>
<dd><p>Identifies potential SOMOs by projecting occupied alpha orbitals onto the beta orbital space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfolder</strong> (<em>str</em>) – Path to the folder containing the Gaussian log file.</p></li>
<li><p><strong>logfile</strong> (<em>str</em>) – Name of the Gaussian .log file.</p></li>
<li><p><strong>function</strong> (<em>This</em>)</p></li>
<li><p><strong>file.</strong> (<em>- Loads orbital data from the log</em>)</p></li>
<li><p><strong>βᵀ.</strong> (<em>- Computes the projection matrix P = A Aᵀ where A = α_occ · S ·</em>)</p></li>
<li><p><strong>eigenvalues.</strong> (<em>- Diagonalizes P and plots its</em>)</p></li>
<li><p><strong>orbitals.</strong> (<em>- Flags alpha orbitals with eigenvalues &gt; 0.5 that project mainly onto virtual beta</em>)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.proj.parse_beta_contrib_string">
<span class="sig-prename descclassname"><span class="pre">somos.proj.</span></span><span class="sig-name descname"><span class="pre">parse_beta_contrib_string</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">s</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.proj.parse_beta_contrib_string" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.proj.print_eigen_analysis">
<span class="sig-prename descclassname"><span class="pre">somos.proj.</span></span><span class="sig-name descname"><span class="pre">print_eigen_analysis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eigenvalues</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.proj.print_eigen_analysis" title="Link to this definition"></a></dt>
<dd><p>Prints and analyzes the eigenvalues of the projection matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eigenvalues</strong> (<em>np.ndarray</em>) – Eigenvalues of the projection matrix (real and ≥ 0).</p></li>
<li><p><strong>threshold</strong> (<em>float</em>) – Eigenvalues below this threshold are considered “low” (possible SOMO signature).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.proj.project_occupied_alpha_onto_beta">
<span class="sig-prename descclassname"><span class="pre">somos.proj.</span></span><span class="sig-name descname"><span class="pre">project_occupied_alpha_onto_beta</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logfolder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold_beta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.proj.project_occupied_alpha_onto_beta" title="Link to this definition"></a></dt>
<dd><p>Projects each occupied alpha orbital onto the full set of beta orbitals (occupied + virtual)
using the AO overlap matrix. Returns a summary DataFrame including projection norms,
dominant beta contributions, and diagnostic flags.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logfolder</strong> (<em>str</em>) – Path to the folder containing the Gaussian log file.</p></li>
<li><p><strong>logfile</strong> (<em>str</em>) – Name of the Gaussian log file.</p></li>
<li><p><strong>threshold_beta</strong> (<em>float</em><em>, </em><em>optional</em>) – Percentage threshold (default: 20) above which a beta orbital is considered significant in the projection.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with one row per occupied alpha orbital and the following columns:
- ‘Alpha OM’: Index (1-based) of the alpha orbital
- ‘Occ α’: Occupation of the alpha orbital (usually ‘O’)
- ‘Energy (Ha)’: Energy of the alpha orbital
- ‘Projection² on β_virtual’: Squared norm of the projection onto the virtual beta space
- ‘Projection² on β_occupied’: Squared norm of the projection onto the occupied beta space
- ‘Dominant β MO’: Index (1-based) of the beta orbital with the largest projection
- ‘Index4Jmol’: Jmol-compatible index for the dominant beta orbital
- ‘Occ β’: Occupation of the dominant beta orbital (‘V’ or ‘O’)
- ‘E (β, Ha)’: Energy of the dominant beta orbital
- ‘Top 1 contrib (%)’: Percentage of the total projection norm carried by the most contributing beta orbital
- ‘Top 2 contrib (%)’: Cumulative contribution of the top 2 beta orbitals
- ‘Top 3 contrib (%)’: Cumulative contribution of the top 3 beta orbitals
- ‘Dominance ratio’: Largest single contribution / total projection
- ‘Spread?’: Flag indicating whether the projection is distributed (“Yes” if &lt;60% dominance)
- ‘β orbitals &gt;{threshold_beta}%’: List of tuples [OM index (1-based), contribution (%)] for beta orbitals contributing &gt;{threshold_beta value}%
- ‘SOMO?’: Yes if projection is dominant onto virtual space and small on occupied</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The squared projection of an occupied alpha orbital ( phi^lpha_i ) onto the full beta space is computed as:</p>
<p>[
mathbf{v}_i = phi^lpha_i cdot S cdot (phi^eta)^T
]</p>
<p>where ( S ) is the AO overlap matrix, and ( phi^eta ) is the matrix of beta MOs. The squared norm ( |mathbf{v}_i|^2 ) represents the total overlap.</p>
<p>Top-N contributions are computed by squaring the individual projections ( v_{ij} ), sorting them, and evaluating the cumulative contributions from the top 1, 2, or 3 beta orbitals. These are returned as “Top 1 contrib (%)”, “Top 2 contrib (%)”, and “Top 3 contrib (%)”.</p>
<p>The column “β orbitals &gt;{threshold_beta}%” lists all beta orbitals contributing more than the specified percentage to the squared projection norm, with both their index (1-based) and contribution in percent.</p>
<p>The flag “SOMO?” is set to “Yes” if the squared projection on the virtual beta subspace is greater than 0.5, and the projection on the occupied beta subspace is below 0.5.</p>
<p>The total number of beta orbitals ( N ) used in the projection is equal to the total number of molecular orbitals in the beta spin channel. The projection is performed over the complete beta space, regardless of occupation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.proj.projection_heatmap_from_df">
<span class="sig-prename descclassname"><span class="pre">somos.proj.</span></span><span class="sig-name descname"><span class="pre">projection_heatmap_from_df</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nbasis</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfolder</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./logs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'logfile.log'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.proj.projection_heatmap_from_df" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="somos.proj.show_alpha_to_homo">
<span class="sig-prename descclassname"><span class="pre">somos.proj.</span></span><span class="sig-name descname"><span class="pre">show_alpha_to_homo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_proj</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfolder</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight_somo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#somos.proj.show_alpha_to_homo" title="Link to this definition"></a></dt>
<dd><p>Affiche les lignes du DataFrame df_proj correspondant aux orbitales alpha
allant de l’α 1 jusqu’à la HOMO, avec surlignage facultatif des SOMOs.</p>
<section id="parametres">
<h2>Paramètres<a class="headerlink" href="#parametres" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>df_proj<span class="classifier">pd.DataFrame</span></dt><dd><p>DataFrame contenant les résultats de projection alpha → beta.</p>
</dd>
<dt>logfolder<span class="classifier">str</span></dt><dd><p>Dossier contenant le fichier log.</p>
</dd>
<dt>logfile<span class="classifier">str</span></dt><dd><p>Nom du fichier log.</p>
</dd>
<dt>highlight_somo<span class="classifier">bool</span></dt><dd><p>Si True, surligne les lignes avec SOMO? == “Yes”.</p>
</dd>
</dl>
</section>
<section id="retourne">
<h2>Retourne<a class="headerlink" href="#retourne" title="Link to this heading"></a></h2>
<dl class="simple">
<dt>pd.DataFrame ou Styler</dt><dd><p>Un sous-ensemble stylisé ou brut du DataFrame.</p>
</dd>
</dl>
</section>
</dd></dl>

<div class="toctree-wrapper compound">
</div>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Romuald Poteau.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>